#!/bin/bash

function run_debug_tests
{
   echo "pre-commit: Building Debug $1."
   osname=$(uname --operating-system)
   if [ $osname == "Linux" ]; then
      cmake --build Debug --config Debug
   elif [ $osname == "Msys" ]; then
      cmake --build . --config Debug
   fi   
   echo "pre-commit: Running Debug $1."   
   if [ $osname == "Linux" ]; then
      Debug/"$1"/"$1" 1>/dev/null
   elif [ $osname == "Msys" ]; then
      "$1"/Debug/"$1".exe 1>/dev/null
   fi   
   exitCode=$?
   if [ $exitCode -ne 0 ]; then
      echo "pre-commit: Debug $1 failed with exit code $exitCode. Disallowing commit."
      #exit 1
   fi
   echo "pre-commit: Debug $1 passed. Allowing commit."
}

run_debug_tests ZenUnitTests
run_debug_tests ExamplesTests
